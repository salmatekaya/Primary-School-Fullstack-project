{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Lenovo\\\\Desktop\\\\Finalversionproject\\\\primary-school-frontend\\\\src\\\\pages\\\\Teacher\\\\Presence\\\\Presence.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Button from '@material-ui/core/Button';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Axios from 'axios';\nimport useTable from '../../../components/useTable';\nimport { TableBody, TableRow, TableCell } from '@material-ui/core';\nimport EditableRowP from './EditableRowP';\nimport ReadOnlyRowP from './ReadOnlyRowP';\nimport Popup from '../../../components/Popup';\nimport AddP from './AddP';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  paper: {\n    marginTop: theme.spacing(8),\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center'\n  },\n  form: {\n    width: '100%',\n    // Fix IE 11 issue.\n    marginTop: theme.spacing(1)\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2)\n  },\n  pageContent: {\n    margin: theme.spacing(5),\n    padding: theme.spacing(3)\n  },\n  newButton: {\n    position: 'absolute',\n    right: '10px'\n  }\n}));\nconst headCells = [{\n  id: 'actions',\n  label: 'أجراءات'\n}, {\n  id: 'year',\n  label: 'السنة الدراسية'\n}, {\n  id: 'year',\n  label: ' نهاية الغياب'\n}, {\n  id: 'year',\n  label: 'بداية الغياب'\n}, {\n  id: 'number',\n  label: 'الـيـوم'\n}, {\n  id: 'name',\n  label: 'رقم تسجيل التلميذ'\n}];\n\nconst Presence = () => {\n  _s();\n\n  const classes = useStyles();\n  const [id, setID] = useState('');\n  const [editPresenceId, setEditPresenceId] = useState(null);\n  const [editFormData, setEditFormData] = useState({\n    inscription: \"\",\n    jour: \"\",\n    firsthour: \"\",\n    lasthour: \"\",\n    annee: \"\"\n  });\n  const [inscri, setInscri] = useState('');\n  const [newInscri, setNewInscri] = useState('');\n  const [lastname, setLastname] = useState();\n  const [newDay, setNewDay] = useState('');\n  const [username, setUsername] = useState('');\n  const [newFirsthour, setNewFirsthour] = useState('');\n  const [newGender, setNewGender] = useState('');\n  const [newLasthour, setNewLasthour] = useState('');\n  const [newYear, setNewYear] = useState('');\n  const [presenceList, setPresenceList] = useState([]);\n  const [newPresenceList, setNewPresenceList] = useState([]);\n  const [openPopup, setOpenPopup] = useState(false);\n  const [idS, setIdS] = useState('');\n\n  function refreshPage() {\n    window.location.reload(false);\n  }\n\n  const {\n    TblContainer,\n    TblHead\n  } = useTable(presenceList, headCells);\n  useEffect(() => {\n    Axios.get(\"http://localhost:3000/getPresence\").then(response => {\n      setPresenceList(response.data);\n    });\n  }, []);\n\n  const handleEditClick = (event, val) => {\n    event.preventDefault();\n    setEditPresenceId(val.id_absence);\n    const formValues = {\n      ideleve: val.id_eleve,\n      jour: val.jour,\n      heuredebut: val.heure_debut,\n      heurefin: val.heure_fin,\n      annee: val.anneescolaie\n    };\n    setEditFormData(formValues);\n  };\n\n  const handleEditChange = event => {\n    event.preventDefault();\n    const fieldName = event.target.getAttribute(\"name\");\n    const fieldValue = event.target.value;\n    const newData = { ...editFormData\n    };\n    newData[fieldName] = fieldValue;\n  };\n\n  const deleteAbsence = id_absence => {\n    Axios.delete(`http://localhost:3000/deletePresence/${id_absence}`);\n    console.log('deleted');\n    console.log(id_absence);\n  };\n\n  const updateStudentInscri = id => {\n    Axios.put(\"http://localhost:3000/updateStudentInscri\", {\n      inscription: newInscri,\n      id_absence: id\n    });\n    console.log(newInscri);\n  };\n\n  const updateDate = id => {\n    Axios.put(\"http://localhost:3000/updateStudentDay\", {\n      jour: newDay,\n      id_absence: id\n    });\n    console.log(newDay);\n  };\n\n  const updateFirsthour = id => {\n    Axios.put(\"http://localhost:3000/updateStudentFirsthour\", {\n      heuredebut: newFirsthour,\n      id_absence: id\n    });\n    console.log(newFirsthour);\n  };\n\n  const updateLasthour = id => {\n    Axios.put(\"http://localhost:3000/updateStudentLasthour\", {\n      heurefin: newLasthour,\n      id_absence: id\n    });\n    console.log(newLasthour);\n  };\n\n  const updateYear = id => {\n    Axios.put(\"http://localhost:3000/updateStudentYear\", {\n      annee: newYear,\n      id_absence: id\n    });\n    console.log(newYear);\n  };\n\n  const handleCancelClick = () => {\n    setEditPresenceId(null);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Button, {\n      class: \"ui right floated blue basic button\",\n      onClick: () => {\n        setOpenPopup(true);\n      },\n      children: \" \\u062A\\u0633\\u062C\\u064A\\u0644 \\u063A\\u064A\\u0627\\u0628 \\u0627\\u0644\\u062A\\u0644\\u0645\\u064A\\u0630   \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(TblContainer, {\n      children: [/*#__PURE__*/_jsxDEV(TblHead, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n        children: presenceList.map(val => /*#__PURE__*/_jsxDEV(React.Fragment, {\n          children: editPresenceId === val.id_absence ? /*#__PURE__*/_jsxDEV(EditableRowP, {\n            editFormData: editFormData,\n            handleEditChange: handleEditClick,\n            setNewInscri: setNewInscri,\n            setNewDay: setNewDay,\n            setNewFirsthour: setNewFirsthour,\n            setNewLasthour: setNewLasthour,\n            setNewYear: setNewYear,\n            val: val,\n            refreshPage: refreshPage,\n            updateStudentInscri: updateStudentInscri,\n            updateDate: updateDate,\n            updateFirsthour: updateFirsthour,\n            updateLasthour: updateLasthour,\n            updateYear: updateYear,\n            newPresenceList: newPresenceList,\n            handleCancelClick: handleCancelClick,\n            handleEditChange: handleEditChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 25\n          }, this) : /*#__PURE__*/_jsxDEV(ReadOnlyRowP, {\n            val: val,\n            handleEditClick: handleEditClick,\n            deleteAbsence: deleteAbsence,\n            refreshPage: refreshPage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 27\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 23\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Popup, {\n      openPopup: openPopup,\n      setOpenPopup: setOpenPopup,\n      children: /*#__PURE__*/_jsxDEV(AddP, {\n        setOpenPopup: setOpenPopup\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 160,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Presence, \"2rqSrjSHZn11JtudYZ7DFjLoIr4=\", false, function () {\n  return [useStyles, useTable];\n});\n\n_c = Presence;\nexport default Presence;\n\nvar _c;\n\n$RefreshReg$(_c, \"Presence\");","map":{"version":3,"sources":["C:/Users/Lenovo/Desktop/Finalversionproject/primary-school-frontend/src/pages/Teacher/Presence/Presence.js"],"names":["React","useState","useEffect","Button","makeStyles","Axios","useTable","TableBody","TableRow","TableCell","EditableRowP","ReadOnlyRowP","Popup","AddP","useStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","form","width","submit","margin","pageContent","padding","newButton","position","right","headCells","id","label","Presence","classes","setID","editPresenceId","setEditPresenceId","editFormData","setEditFormData","inscription","jour","firsthour","lasthour","annee","inscri","setInscri","newInscri","setNewInscri","lastname","setLastname","newDay","setNewDay","username","setUsername","newFirsthour","setNewFirsthour","newGender","setNewGender","newLasthour","setNewLasthour","newYear","setNewYear","presenceList","setPresenceList","newPresenceList","setNewPresenceList","openPopup","setOpenPopup","idS","setIdS","refreshPage","window","location","reload","TblContainer","TblHead","get","then","response","data","handleEditClick","event","val","preventDefault","id_absence","formValues","ideleve","id_eleve","heuredebut","heure_debut","heurefin","heure_fin","anneescolaie","handleEditChange","fieldName","target","getAttribute","fieldValue","value","newData","deleteAbsence","delete","console","log","updateStudentInscri","put","updateDate","updateFirsthour","updateLasthour","updateYear","handleCancelClick","map"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Axios from 'axios';\r\nimport useTable from '../../../components/useTable';\r\nimport { TableBody, TableRow,TableCell } from '@material-ui/core';\r\nimport EditableRowP from './EditableRowP';\r\nimport ReadOnlyRowP from './ReadOnlyRowP';\r\nimport Popup from '../../../components/Popup';\r\nimport AddP from './AddP';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  paper: {\r\n    marginTop: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  form: {\r\n    width: '100%', // Fix IE 11 issue.\r\n    marginTop: theme.spacing(1),\r\n  }, \r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n  pageContent: {\r\n    margin: theme.spacing(5),\r\n    padding: theme.spacing(3)\r\n  },\r\n  newButton:{\r\n      position:'absolute',\r\n      right:'10px'\r\n  }\r\n}));\r\n\r\nconst headCells=[\r\n    {id:'actions',label:'أجراءات'},\r\n    {id:'year', label:'السنة الدراسية'},\r\n    {id:'year', label:' نهاية الغياب'},\r\n    {id:'year', label:'بداية الغياب'},\r\n    {id:'number', label:'الـيـوم'},\r\n    {id:'name', label:'رقم تسجيل التلميذ'},\r\n]\r\n\r\nconst Presence = () => {\r\n  const classes = useStyles();\r\n  const [id,setID]=useState(''); \r\n  const [editPresenceId,setEditPresenceId] = useState(null);\r\n  const [editFormData,setEditFormData]=useState({\r\n   inscription:\"\",\r\n    jour:\"\",\r\n   firsthour:\"\",\r\n   lasthour:\"\",\r\n   annee:\"\"\r\n  })\r\n\r\n\r\n  const [inscri,setInscri] = useState('');\r\n   const [newInscri,setNewInscri]=useState('');\r\n\r\n  const [lastname,setLastname]=useState();\r\n  const [newDay,setNewDay]=useState('');\r\n\r\n  const [username,setUsername]=useState('');\r\n  const [newFirsthour,setNewFirsthour]=useState('');\r\n\r\n  const [newGender,setNewGender]=useState('');\r\n  const [newLasthour,setNewLasthour]=useState('');\r\n  const [newYear,setNewYear]=useState('');\r\n  const [presenceList, setPresenceList]=useState([]);\r\n  const [newPresenceList,setNewPresenceList]=useState([]);\r\n  const [openPopup,setOpenPopup]=useState(false);\r\n  const [idS,setIdS] = useState('');\r\n\r\nfunction refreshPage() {\r\n    window.location.reload(false); \r\n  }\r\n\r\n  const {\r\n      TblContainer,\r\n      TblHead\r\n    }=useTable(presenceList,headCells);\r\n\r\n  useEffect(()=>{\r\n    Axios.get(\"http://localhost:3000/getPresence\").then((response)=>{\r\n      setPresenceList(response.data)\r\n    })\r\n  },[])\r\n\r\n  const handleEditClick = (event,val) => {\r\n    event.preventDefault();\r\n    setEditPresenceId(val.id_absence);\r\n\r\n    const formValues={\r\n      ideleve:val.id_eleve,\r\n      jour:val.jour,\r\n     heuredebut:val.heure_debut,\r\n      heurefin:val.heure_fin,\r\n      annee:val.anneescolaie  \r\n    }\r\n    setEditFormData(formValues);\r\n  };\r\n\r\n  const handleEditChange=(event)=>{\r\n    event.preventDefault();\r\n\r\n    const fieldName=event.target.getAttribute(\"name\");\r\n    const fieldValue=event.target.value;\r\n\r\n    const newData={...editFormData};\r\n    newData[fieldName]=fieldValue;\r\n  }\r\n\r\n  const deleteAbsence = (id_absence) => {\r\n    Axios.delete(`http://localhost:3000/deletePresence/${id_absence}`)\r\n    console.log('deleted');\r\n    console.log(id_absence);\r\n  };\r\n\r\n  const updateStudentInscri=(id)=>{\r\n    Axios.put(\"http://localhost:3000/updateStudentInscri\",{\r\n        inscription:newInscri,id_absence:id\r\n    });    \r\n      console.log(newInscri);\r\n \r\n  }\r\n\r\n  const updateDate=(id)=>{\r\n    Axios.put(\"http://localhost:3000/updateStudentDay\",{\r\n      jour:newDay,id_absence:id\r\n    });\r\n      console.log(newDay); \r\n  }\r\n\r\n  const updateFirsthour=(id)=>{\r\n    Axios.put(\"http://localhost:3000/updateStudentFirsthour\",{\r\n      heuredebut:newFirsthour,id_absence:id,\r\n    });\r\n      console.log(newFirsthour);\r\n  }\r\n\r\n  const updateLasthour=(id)=>{\r\n    Axios.put(\"http://localhost:3000/updateStudentLasthour\",{\r\n      heurefin:newLasthour,id_absence:id\r\n    });\r\n      console.log(newLasthour);\r\n  }\r\n  const updateYear=(id)=>{\r\n    Axios.put(\"http://localhost:3000/updateStudentYear\",{\r\n      annee:newYear,id_absence:id\r\n    });\r\n      console.log(newYear);\r\n  }\r\n\r\n  const handleCancelClick=()=>{\r\n   setEditPresenceId(null);\r\n  }\r\n\r\n  return (\r\n    <div>\r\n        <Button class=\"ui right floated blue basic button\" onClick={()=> {setOpenPopup(true)}}> تسجيل غياب التلميذ   </Button>\r\n        <TblContainer >\r\n            <TblHead/>\r\n            <TableBody >\r\n                {presenceList.map((val)=>(\r\n                      <React.Fragment>  \r\n                        {editPresenceId === val.id_absence?  ( \r\n                        <EditableRowP\r\n                          editFormData={editFormData}\r\n                          handleEditChange={handleEditClick}\r\n                          setNewInscri={setNewInscri}\r\n                          setNewDay={setNewDay}\r\n                          setNewFirsthour={setNewFirsthour} \r\n                          setNewLasthour={setNewLasthour}\r\n                          setNewYear={setNewYear}\r\n                          val={val} \r\n                          refreshPage={refreshPage}\r\n                          updateStudentInscri={updateStudentInscri}\r\n                          updateDate={updateDate}\r\n                          updateFirsthour={updateFirsthour}\r\n                          updateLasthour={updateLasthour}\r\n                          updateYear={updateYear}\r\n                          newPresenceList={newPresenceList} \r\n                          handleCancelClick={handleCancelClick}\r\n                          handleEditChange={handleEditChange}\r\n                        /> \r\n                        ) : (\r\n                          <ReadOnlyRowP\r\n                           val={val}\r\n                            handleEditClick={handleEditClick} \r\n                            deleteAbsence={deleteAbsence}\r\n                            refreshPage={refreshPage}\r\n                          />\r\n                        )\r\n                        }\r\n                      </React.Fragment>\r\n                ))}\r\n            </TableBody>\r\n        </TblContainer>\r\n\r\n        <Popup\r\n        openPopup={openPopup}\r\n        setOpenPopup={setOpenPopup}\r\n        >\r\n            <AddP setOpenPopup={setOpenPopup}/>\r\n        </Popup>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Presence; "]},"metadata":{},"sourceType":"module"}